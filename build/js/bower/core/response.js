define(["underscore","lib/app","lib/messenger","entity/from-json"],function(r,e,n,t){"use strict";function s(t,s){var i,o=r(t.message()).reduce(function(r,t){var s=t.isError()&&n.TYPE_ERROR||n.TYPE_MESSAGE;return t.isError()&&console.warn(t.text(),t.trace().split("\n")),e.trigger("messenger:show",[s,t.text()]),null===r&&t.isError()&&t.text()||null},null),u=o&&new Error(o)||null,l=t.payload();return t.redirect()?(document.location.href=t.redirect(),null):r.isEmpty(l)?s(null,null):(i=l.shift(),s(u,i.data()))}function i(e,n){return r.isObject(e)&&(e=JSON.stringify(e)),t(e,function(r,e){r?u(r,n):s(e,n)})}function o(r,e){return r.responseText?i(r.responseText,e):u(new Error("Application Error"),e)}function u(r,t){return e.trigger("messenger:show",[n.TYPE_ERROR,r.message]),t(r)}return{parse:i,error:o}});
//# sourceMappingURL=response.js.map