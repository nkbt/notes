define(["module","dom","underscore","lib/app","txt!messenger/html/template.html","txt!messenger/html/error.html","txt!messenger/html/message.html","txt!messenger/html/progress.html"],function(e,s,r,t){"use strict";function n(e,n){if(!r.findWhere(h.types,e))return null;var m=t.$root.find(".messenger"),g=[];return m.length||(m=s(f.container),m.appendTo(t.$root)),e===h.types.TYPE_PROGRESS&&(g=m.find(".messenger-progress"),g.length)?(g.find(".messenger-text").html(n),t.trigger(g,"messenger:show:done",[e,n]).trigger(g,"messenger:hideDelayed")):(g.length?g.find(".messenger-text").html(n):(g=s(f[e]),g.prependTo(m)),g.find(".messenger-text").html(n),t.trigger(g,"messenger:show:done",[e,n]).trigger(g,"messenger:hideDelayed"))}function m(e,s,r){return n(s,r)}function g(){return r.each(t.$root.find(".messenger-progress"),i)}function o(e){var r=s(e),t=r.data("messenger-hideTimer");t&&(window.clearTimeout(t),t=null),r.data("messenger-hideTimer",t)}function i(e){if(r.isEmpty(e))return r.each(t.$root.find(".messenger-message"),i);var n=s(e).closest(".messenger-message");return o(n),n.remove()}function a(e){return function(){i(e)}}function u(e){var s=t.getElement(e,".messenger-message"),r=parseInt(parseInt(s.data("messenger-autohide"),10)||h.hideTimeout,10);return o(s),s.data("messenger-hideTimeout",window.setTimeout(a(s),r))}function l(e){var s=t.getElement(e,".messenger-message");return o(s),i(s)}function d(e){var s=t.getElement(e,".messenger-message");return o(s)}t.log("Loaded");var h=r.defaults(e.config(),{hideTimeout:2e3,types:{TYPE_ERROR:"error",TYPE_MESSAGE:"message",TYPE_PROGRESS:"progress"}}),f={container:require("txt!messenger/html/template.html"),error:require("txt!messenger/html/error.html"),message:require("txt!messenger/html/message.html"),progress:require("txt!messenger/html/progress.html")};return t.on("messenger:show",null,m).on("messenger:progressStop",null,g).on("click",".messenger .messenger-message",l).on("mouseover",".messenger .messenger-message[data-messenger-autohide]",d).on("mouseout",".messenger .messenger-message[data-messenger-autohide]",u).on("messenger:hideDelayed",".messenger .messenger-message[data-messenger-autohide]",u),h.types});
//# sourceMappingURL=messenger.js.map